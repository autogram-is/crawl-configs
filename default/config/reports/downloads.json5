// Non-HTML pages crawled; by default PDFs, Photos, Audio files,
// and Videos are split onto their own sheets with custom metadata.
// If no files are set to be downloaded in the spider config, this
// report will be empty.

{
  reports: {
    media: {
      name: 'Downloadable Files',
      group: 'project',
      description: 'Non-HMTL files linked by project sites',
      queries: {
        'Overview': {
          parent: 'project_summary',
          aggregates: [
            { path: 'mime', function: 'collect' },
          ],
          filters: [
            { path: 'mime', eq: 'text/html', negate: true },
          ],
        },
        'PDFs': {
          parent: 'project_media',
          filters: [{ path: 'mime', eq: 'application/pdf' }],
          return: [
            { name: 'Title', path: 'content.title' },
            { name: 'Date', path: 'content.date' },
            { name: 'Pages', path: 'data.pages' },
            { name: 'Words', path: 'content.readability.words' },
            { name: 'Language', path: 'data.info.Language' },
            { name: 'Links', path: 'content.urls', function: 'LENGTH' },
          ]
        },
        'Photos': {
          parent: 'project_media',
          filters: [{ path: 'mime', in: ['image/png', 'image/jpeg'] }],
          return: [
            { name: 'Date', path: 'data.ModifyDate' },
            { name: 'Height', path: 'data.height' },
            { name: 'Width', path: 'data.width' },
            { name: 'Copyright', path: 'data.Copyright' },
          ]
        },
        'Audio': {
          parent: 'project_media',
          filters: [{ path: 'mime', eq: 'audio/mpeg' }],
          return: [
            { name: 'Duration', path: 'data.format.duration' },
          ]
        },
        'Videos': {
          parent: 'project_media',
          filters: [{ path: 'mime', eq: 'video/mp4' }],
          return: [
            { name: 'Date', path: 'data.format.creationTime' },
            { name: 'Duration', path: 'data.format.duration' },
          ]
        },
        'Other Files': {
          parent: 'project_media',
          filters: [{ path: 'mime', in: ['application/pdf', 'image/png', 'image/jpeg', 'audio/mpeg', 'video/mp4'], negate: true }]
        }
      }
    }
  }
}